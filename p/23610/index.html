<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Answering Arrogance with Pride, And Prejudice with Persistence."><meta name="keyword" content="Harold_404"><meta name="theme-color" content="#600090"><meta name="msapplication-navbutton-color" content="#600090"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#600090"><link rel="shortcut icon" href="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/index/favicon.png"><link rel="alternate" type="application/atom+xml" title="Harold_404" href="/atom.xml"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css"><title>Penetration One Hour - Part I｜Harold_404&#39;s Blog</title><link rel="canonical" href="http://har01d.me/p/23610/"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/blog-style.css"><link rel="stylesheet" href="/css/syntax.css"></head><style>header.intro-header{background-image:url(https://blog-1253219581.cos.ap-chengdu.myqcloud.com/index/avatar.jpg)}</style><body ontouchstart="" class="animated fadeIn"><nav class="navbar navbar-default navbar-custom navbar-fixed-top" id="nav-top" data-ispost="true" data-istags="false
" data-ishome="false"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand animated pulse" href="/"><span class="brand-logo">Harold_404 </span>'s Blog</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">Home</a></li><li><a href="/tags/">TAGS</a></li><li><a href="/about/">ABOUT</a></li><li><a href="/archive/">ARCHIVE</a></li></ul></div></div></div></nav><script>var $toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");function handleMagic(e){0<$navbar.className.indexOf("in")?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}$toggle.addEventListener("click",handleMagic)</script><img class="wechat-title-img" src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/cover/cover01.jpg"><style>header.intro-header{background-image:url(https://blog-1253219581.cos.ap-chengdu.myqcloud.com/cover/cover01.jpg)}</style><header class="intro-header"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center"><div class="post-heading"><h1>Penetration One Hour - Part I</h1><span class="meta">作者 Harold_404 <span>日期 2019-03-21</span></span><div class="tags text-center"><a class="tag" href="/tags/#Web Security" title="Web Security">Web Security</a> <a class="tag" href="/tags/#Penetration One Hour" title="Penetration One Hour">Penetration One Hour</a></div></div></div></div></div><div class="post-title-haojen"><span>Penetration One Hour - Part I</span></div></header><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container"><h1 id="Overview"><a href="#Overview" class="headerlink" title="#  Overview"></a># Overview</h1><p>早上起来想着看会儿书准备一下面试，想着再看看公司的介绍，就去官网溜达溜达，意外发现了 admin 的二级域名，于是就有了这篇文章。</p><h2 id="环境信息泄露"><a href="#环境信息泄露" class="headerlink" title="## 环境信息泄露"></a>## 环境信息泄露</h2><p>报错成功，显示为 <code>ASP.NET 2.0.50727</code>，挺老的版本了，先查下 CVE 备着，继续看看别的。</p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/1.png" alt=""></p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/2.png" alt=""></p><h2 id="Clickjacking（点击劫持）"><a href="#Clickjacking（点击劫持）" class="headerlink" title="## Clickjacking（点击劫持）"></a>## Clickjacking（点击劫持）</h2><p>看了下 HTTP Request 包，没有配置 <code>X-Frame-Options</code> 头，也就是说允许在<frame>、<iframe>或者 <object>等各类标记中嵌入页面内容，只要能拿下 Stored XSS 的话就可以伪造内网登陆界面了。</object></iframe></p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/3.png" alt=""></p><p>安全的网站应该存在的 <code>X-Frame-Options</code> 头：</p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/4.png" alt=""></p><h2 id="客户服务中心-Cookie-劫持攻击"><a href="#客户服务中心-Cookie-劫持攻击" class="headerlink" title="## 客户服务中心 Cookie 劫持攻击"></a>## 客户服务中心 Cookie 劫持攻击</h2><p>二级域名 <code>csc</code>是一个客户服务中心的登陆页面，没有发现注入攻击，不过在检查 HTTP 返回头的时候发现 Cookie 并没有设置 HttpOnly 属性：</p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/7.png" alt=""></p><p>这导致 JavaScript 能够获取到 Cookie 的值，一旦用户的 Cookie 发生泄漏，在未设置 token 或未将 Cookie 与 IP 绑定的情况下，登录用户的账号就会十分轻松。</p><p>好在二级域名 <code>csc</code> 实现了 HTTPS 协议（然而二级域名 <code>admin</code> 并没有…），出现 Cookie 泄露的情况应该不会发生。</p><h2 id="不安全的-method-方法-OPTIONS"><a href="#不安全的-method-方法-OPTIONS" class="headerlink" title="## 不安全的 method 方法 - OPTIONS"></a>## 不安全的 method 方法 - OPTIONS</h2><p>支持的 method 方法包括：OPTIONS, TRACE, GET, HEAD。OPTIONS 方法可能会导致网站的主要敏感信息泄露，还是在 Server 端禁用掉会好一些。</p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/5.png" alt=""></p><h2 id="CVE-2008-5100"><a href="#CVE-2008-5100" class="headerlink" title="## CVE-2008-5100"></a>## CVE-2008-5100</h2><p>根据刚才泄露的环境信息，找到了一个高危漏洞，时间比较早了，如果前端上了 WAF 的话应该已经被修复了，本来还想再试一下，看时间也该出发去面试了，这次的 Penetration One Hour 就先到这里吧。─=≡Σ((( つ•̀ω•́)つ</p><p><img src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/post/004/6.png" alt=""></p><hr><div><p></p><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> <a href="https://har01d.me" target="_blank">Harold_404</a></li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://har01d.me/p/23610/">Penetration One Hour - Part I</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" rel="external nofollow" target="_blank">CC BY-NC-ND 4.0</a> 许可协议。转载请注明出处。</li></ul></div><hr><ul class="pager"><li class="next"><a href="/p/20588/" data-toggle="tooltip" data-placement="top" title="DVWA 渗透笔记（一）">Next Post &rarr;</a></li></ul><div id="container"></div><link rel="stylesheet" href="https://www.wenjunjiang.win/css/gitment.css"><script src="https://www.wenjunjiang.win/js/gitment.js"></script><script>var gitment=new Gitment({id:window.location.pathname,owner:"Harold-404",repo:"Harold-404.github.io",oauth:{client_id:"047b196aff681a5f5d05",client_secret:"98bbc1253133cf989768803d4de272beec68c83a"}});gitment.render("container")</script></div><div class="hidden-xs col-sm-3 toc-col"><div class="toc-wrap"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Overview"><span class="toc-text"># Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境信息泄露"><span class="toc-text">## 环境信息泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Clickjacking（点击劫持）"><span class="toc-text">## Clickjacking（点击劫持）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客户服务中心-Cookie-劫持攻击"><span class="toc-text">## 客户服务中心 Cookie 劫持攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#不安全的-method-方法-OPTIONS"><span class="toc-text">## 不安全的 method 方法 - OPTIONS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2008-5100"><span class="toc-text">## CVE-2008-5100</span></a></li></ol></li></ol></div></div></div><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"></div></div></div></article><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center"><br><ul class="list-inline text-center"><li><a target="_blank" href="https://twitter.com/Harold_404"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="http://weibo.com/Harold_404"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-weibo fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" href="https://github.com/Harold-404"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Harold_404 2019<br><span id="busuanzi_container_site_pv" style="font-size:12px;color:#fff">PV: <span id="busuanzi_value_site_pv"></span> Times</span><br></p></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/blog.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",function(e){n(null,e)},!1),c.parentNode.insertBefore(r,c)}</script><script>0!==$("#tag_cloud").length&&async("http://har01d.me/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js",function(){var c=document.querySelector("nav");c&&FastClick.attach(c)})</script><script type="text/javascript">!function(t,e,n,s,c,i,a){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},i=e.createElement(n),a=e.getElementsByTagName(n)[0],i.async=1,i.src="//s.swiftypecdn.com/install/v2/st.js",a.parentNode.insertBefore(i,a)}(window,document,"script",0,"_st"),_st("install","","2.0.0")</script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><img class="wechat-title-img" src="https://blog-1253219581.cos.ap-chengdu.myqcloud.com/index/avatar.jpg"><link rel="stylesheet" href="/dist/APlayer.min.css"><div id="aplayer"></div><script type="text/javascript" src="/dist/APlayer.min.js"></script><script type="text/javascript" src="/dist/music.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-koharu"},"tagMode":false,"display":{"position":"right","width":125,"height":250},"mobile":{"show":"fales"},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body></html>